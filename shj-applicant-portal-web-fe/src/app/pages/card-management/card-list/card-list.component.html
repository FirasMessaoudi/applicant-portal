<div class="content__wrapper">
  <div class="title__Page">
    <h3 class="sectionTitle">
      {{ "card-management.cards_list" | translate }}
      <button class="btn btn-link shadow-none"  (click)="isSearchbarCollapsed = !isSearchbarCollapsed">
        <svg-icon styleClass="h4 pt-3" icon="search"></svg-icon>
      </button>
    </h3>
    <button id="addExceptionalCard" class="btn btn-outline-dcc-primary px-4" *ngIf="canAddCard">
      <svg-icon styleClass="mr-2" icon="plus"></svg-icon> <span>{{ "card-management.add_exceptional_card" | translate }}</span>
    </button>
  </div>
  <div class="content__section" *ngIf="!canSeeCardsList">
    {{'header.welcome' | translate}} <span class="font-weight-bold text-dcc-primary">{{'general.app_name' | translate}}</span>
  </div>

  <div class="content__section" *ngIf="canSeeCardsList">
    <div class="searchBox collapse" [ngbCollapse]="isSearchbarCollapsed">
      <form [formGroup]="searchForm" enctype="multipart/form-data" class="row row-cols-1 row-cols-md-2 row-cols-lg-4">

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.ritual_season" | translate }}</label>
          <select formControlName="ritualSeason" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>2021</option>
            <option>2020</option>
            <option>2019</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.ritual_type" | translate }}</label>
          <select formControlName="ritualType" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>عمرة داخلية</option>
            <option>عمرة خارجية</option>
            <option>حج داخلي</option>
            <option>حج خارجي</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.hamlah" | translate }}</label>
          <select formControlName="hamlah" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>سيف الاسلام</option>
            <option>ضيوف الرحمن</option>
            <option>المشاعر المقدسة</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.motawef" | translate }}</label>
          <select formControlName="motawef" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>مطوف 1</option>
            <option>مطوف 2</option>
            <option>مطوف 3</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.applicant_id" | translate }}</label>
          <input type="text" formControlName="idNumber" class="form-control" value="225448784"/>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.card_number" | translate }}</label>
          <input type="text" formControlName="cardNumber" class="form-control" value="5721023"/>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.card_status" | translate }}</label>
          <select formControlName="cardStatus" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>نشطة</option>
            <option>موقوفة</option>
            <option>منتهية</option>
            <option>ملغية</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.applicant_id_status" | translate }}</label>
          <select formControlName="applicantIdStatus" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>نشطة</option>
            <option>غير نشطة</option>
            <option>منتهية</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "general.gender" | translate }}</label>
          <select formControlName="gender" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>ذكر</option>
            <option>أنثى</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.nationality" | translate }}</label>
          <select formControlName="nationality" class="custom-select">
            <option [ngValue]="null" disabled selected class="hidden">{{"general.select_option" | translate}}</option>
            <option>سعودية</option>
            <option>مصرية</option>
            <option>تونسية</option>
            <option>هندية</option>
            <option>أردنية</option>
          </select>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.passport_number" | translate }}</label>
          <input type="text" formControlName="passportNumber" class="form-control" value="2362845"/>
        </div>

        <div class="form-group col">
          <label class="col-form-label">{{ "card-management.tafweej_number" | translate }}</label>
          <input type="text" formControlName="tafweejNumber" class="form-control" value="2362845"/>
        </div>

        <div class="form-group col-12">
          <button id="searchCard" type="submit" (click)="search()" class="btn btn-dcc-primary px-5 mr-3">
            {{ "general.btn_search" | translate }}
          </button>
        </div>

      </form>
    </div>


    <div class="d-flex justify-content-between bg-dcc-light mt-7 actionBar">
      <div class="bg-white">
        <a id="activateCards" class="btn btn-dcc-light btn-action m-w-r" href="">
          <svg-icon styleClass="mx-3 fa-w-18" icon="magic"></svg-icon>
          <span>تنشيط 25 بطاقة</span>
        </a>
      </div>
      <div class="bg-white">
        <a id="exportExcel" class="btn btn-dcc-light btn-action m-w-l" href="/">
          <svg-icon styleClass="mx-3 fa-w-18" icon="file-excel"></svg-icon>
          تصدير اكسل
        </a>
        <a id="exportPDF" class="btn btn-dcc-light btn-action m-w-l" href="/">
          <svg-icon styleClass="mx-3 fa-w-18" icon="file-pdf"></svg-icon>
          تصدير PDF
        </a>
      </div>
    </div>

    <div class="table-responsive mb-4">
      <table id="cardsSearchResult" class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">
              <div class="custom-control custom-checkbox my-2">
                <input type="checkbox" class="custom-control-input" id="customCheck-01" (click)="selectAllCards()">
                <label class="custom-control-label mx-3" for="customCheck-01"></label>
              </div>
            </th>
            <th scope="col">{{'card-management.applicant_name' | translate}}</th>
            <th scope="col">{{'card-management.applicant_id' | translate}}</th>
            <th scope="col">{{'card-management.card_number' | translate}}</th>
            <th scope="col">{{'card-management.ritual_type' | translate}}</th>
            <th scope="col">{{'card-management.card_status' | translate}}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="!page?.content" class="text-center">
            <td colspan="10">
              <svg-icon styleClass="display-1 text-dcc-light" icon="empty-set" ></svg-icon>
              <p class="text-light-gray mb-3">{{ "general.table_emtpy_text" | translate }}</p>
            </td>
          </tr>
          <tr *ngFor="let card of page?.content">
            <td scope="row">
              <div class="custom-control custom-checkbox my-2">
                <input type="checkbox" class="custom-control-input" id="customCheck-02" value="{{card.id}}">
                <label class="custom-control-label mx-3" for="customCheck-02"></label>
              </div>
            </td>
            <td><a id="cardDetails" [routerLink]="['/cards/details', card?.id]" class="text-dcc-primary font-weight-bold">{{card?.applicantRitual?.applicant?.fullNameAr}} {{card?.applicantRitual?.applicant?.fullNameEn}}</a></td>
            <td>{{card?.applicantRitual?.applicant?.digitalIds[0]?.uin}}</td>
            <td class="ltr">{{card?.referenceNumber}}</td>
            <td class="ltr">{{card?.applicantRitual?.typeCode? lookupService().localizedLabel(ritualTypes, card?.applicantRitual?.typeCode) : ''}}</td>
            <td class="ltr">{{lookupService().localizedLabel(cardStatuses, card?.statusCode)}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <nav aria-label="Page navigation example" *ngIf="page?.content">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="page?.first">
          <a class="page-link" (click)="loadPage(0)" tabindex="-1">{{'general.nav_first' | translate}}</a>
        </li>

        <li class="page-item" [class.disabled]="page?.first">
          <a class="page-link" (click)="loadPage(page?.number-1)" tabindex="-1">{{'general.nav_previous' | translate}}</a>
        </li>
        <li class="page-item active">
          <a class="page-link" (click)="loadPage(page.number)">{{(page?.number + 1) + ' / ' + page?.totalPages}}</a>
        </li>
        <li class="page-item" [class.disabled]="page?.last">
          <a class="page-link" (click)="loadPage(page?.number+1)">{{'general.nav_next' | translate}}</a>
        </li>

        <li class="page-item" [class.disabled]="page?.last">
          <a class="page-link" (click)="loadPage(page?.totalPages-1)">{{'general.nav_last' | translate}}</a>
        </li>
      </ul>
    </nav>

  </div>

</div>
