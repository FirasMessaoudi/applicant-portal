<nav aria-label="breadcrumb" class="pt-2">
  <ol class="breadcrumb bg-white mb-0 px-0 d-none d-md-flex">
    <li class="breadcrumb-item active" aria-current="page ">{{'general.main' | translate}}</li>
    <li class="breadcrumb-item active" aria-current="page "></li>
  </ol>
</nav>

<div class="content__wrapper">
  <div class="title__Page">
    <h3 class="sectionTitle">
      {{'settings.settings' | translate}}
    </h3>
  </div>

  <form>
    <div class="form-row">
      <div class="col-lg-6">
        <div class="d-flex form-group">

          <div class="col-5 col-md-6 p-0 mr-1" role="group">
            <label for="inputEmail4">{{ "settings.season" | translate }}</label>

            <select id="inputEmail4" class="custom-select" (change)="onSeasonChange($event.target.value)"
                    [disabled]="!enableEditRitual">
              <option [value]="season" *ngFor="let season of seasons"
                      [selected]="season==selectedSeason">{{season}}</option>
            </select>

          </div>
          <div class="col-7 col-md-6 p-0" role="group">
            <label for="inputEmail4">{{ "settings.ritual-type" | translate }}</label>

            <div class="input-group flex-nowrap">
              <select id="inputEmail4" class="custom-select" (change)="onApplicantRitualChange($event.target.value)"
                      [disabled]="!enableEditRitual">
                <option [value]="ar.id" *ngFor="let ar of applicantRituals"
                        [selected]="ar.id == selectedApplicantRitual.id">
                  {{
                  ar?.typeCode
                    ? lookupService().localizedLabel(
                      ritualTypes,
                      ar?.typeCode
                    )
                    : ""
                  }}
                  - {{ar?.dateStartHijri | monthDayHijriFormat}}
                </option>
              </select>
              <div class="input-group-append">
                <button class="btn btn-outline-gray-300" type="button" ngbTooltip="تعديل" *ngIf="!enableEditRitual"
                        (click)="editRitual()">
                  <svg-icon styleClass="fa-w-20" icon="edit"></svg-icon>
                </button>
                <button class="btn btn-success" type="button" ngbTooltip="حفظ" *ngIf="enableEditRitual"
                        (click)="saveSelectedRitual()">
                  <svg-icon styleClass="fa-w-18" icon="save"></svg-icon>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="inputEmail4">{{'general.language'|translate}}</label>
          <div class="input-group flex-grow-1 mb-3">
            <div class="setBox flex-grow-1 mr-1" role="group">
              <select class="custom-select" [disabled]="enableEditLanguage"
                      (change)="selectedLanguage=$event.target.value">
                <option value="ar-SA" [selected]="currentLanguage.startsWith('ar')">العربية</option>
                <option value="en-US" [selected]="currentLanguage.startsWith('en')">English</option>
              </select>
            </div>
            <div class="input-group-append">

              <button class="btn btn-outline-gray-300" type="button" ngbTooltip="{{'general.btn_edit'|translate}}"
                      *ngIf="enableEditLanguage"
                      (click)="enableEditLanguage=false">
                <svg-icon styleClass="fa-w-20" icon="edit"></svg-icon>
              </button>
              <button class="btn btn-success" type="button" ngbTooltip="{{'general.btn_save'|translate}}"
                      *ngIf="!enableEditLanguage"
                      (click)="updateUserLanguage()">
                <svg-icon styleClass="fa-w-18" icon="save"></svg-icon>
              </button>
            </div>
          </div>
        </div>

        <form [formGroup]="contactsForm" (ngSubmit)="onSubmit()" class="form-group">

          <div class="d-flex">
            <div class="col-5 col-md-6 p-0 mr-1" role="group">
              <label>   {{"general.email"|translate}} </label>
              <div class="input-group">

                <input type="email" class="form-control"
                       formControlName="email" maxlength="50"
                       [class.is-invalid]="f.email.invalid && f.email.touched"/>
                <div *ngIf="f.email.invalid && f.email.touched" class="invalid-feedback">
                  <div *ngIf="f.email.errors.required">{{'general.field_validation_required' | translate}}</div>
                  <div
                    *ngIf="f.email.invalid &&!f.email.errors?.required">{{'general.field_validation_pattern' | translate}}</div>
                </div>
              </div>
            </div>
            <div class="col-7 col-md-6 p-0" role="group">
              <ng-template #rt let-r="result" let-t="term">
                <ngb-highlight [result]="r.dial_code" [term]="t"></ngb-highlight>
                <span class="flag-icon mx-2 flag-icon-{{r['code'].toLowerCase()}}"></span>
              </ng-template>
              <label> {{"general.mobile_number"|translate}}</label>
              <div class="input-group flex-nowrap">

                <ngx-intl-tel-input
                  [cssClass]="'form-control'"
                  [preferredCountries]="getPreferredCountries()"
                  [enableAutoCountrySelect]="false"
                  [searchCountryFlag]="true"
                  [selectFirstCountry]="false"
                  [selectedCountryISO]="originalCountryCode"
                  [separateDialCode]="true"
                  [maxLength]="15"
                  formControlName="mobileNumber"
                ></ngx-intl-tel-input>

                <div class="input-group-append">
                  <button class="btn btn-outline-gray-300" type="button" ngbTooltip="{{'general.btn_edit'|translate}}"
                          *ngIf="contactsForm.disabled" (click)="setContactsEnabled()">
                    <svg-icon styleClass="fa-w-20" icon="edit"></svg-icon>
                  </button>

                  <button class="btn btn-success" type="button" ngbTooltip="{{'general.btn_save'|translate}}"
                          *ngIf="!contactsForm.disabled" (click)="onSubmit()">
                    <svg-icon styleClass="fa-w-18" icon="save"></svg-icon>
                  </button>
                </div>
              </div>
              <div
                *ngIf="(f.mobileNumber.errors && f.mobileNumber.touched)"
                class="text-danger">
                <div
                  *ngIf="f.mobileNumber.errors?.required"> {{'general.field_validation_required' | translate}} </div>
                <div
                  *ngIf="f.mobileNumber.errors?.validatePhoneNumber">{{'general.field_validation_pattern' | translate}}</div>
                <div
                  *ngIf="f.mobileNumber.errors?.invalid">{{'general.field_validation_pattern' | translate}}</div>
              </div>

            </div>
          </div>

        </form>


        <div class="form-group">

          <a class="btn btn-block btn-outline-dcc-primary px-4 setBox" [routerLink]="['/change-password']"
             routerLinkActive="router-link-active">
            {{ "header.change_password" | translate }}
            <svg-icon styleClass="ml-3 mb-0 h5" icon="lock-alt"></svg-icon>
          </a>
        </div>
      </div>
      <div class="col-lg-6 flex-center">
        <svg-icon styleClass="fa-10x text-dcc-light" icon="cog"></svg-icon>
      </div>
    </div>
  </form>

</div>

<ng-template #showDelete let-modal>

  <div class="modal-body">
    <div class="flex-center-column my-3">
      <svg-icon styleClass="text-dcc-primary-public fa-3x" icon="exclamation-triangle"></svg-icon>
      هل أنت متأكد من أنك تريد تعديل الإعدادات؟
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-dcc-primary px-4 ml-3">حفظ التعديلات</button>
    <button type="button" class="btn btn-light px-5">إلغاء</button>
  </div>
</ng-template>


